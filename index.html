<!DOCTYPE html>
<html>
<head>
    <title>FandomVerse - Ship/Pairings Tracker</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Basic Styles */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: linear-gradient(135deg, #D32F2F 0%, #1A237E 100%); color: #333; min-height: 100vh; padding: 20px; }
        .container { max-width: 1400px; margin: 0 auto; background: #F5F5F5; border-radius: 20px; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); overflow: hidden; padding: 30px; }
        
        /* Header */
        .header { background: linear-gradient(135deg, #2E7D32 0%, #1A237E 100%); color: white; padding: 40px; border-radius: 15px; margin-bottom: 30px; position: relative; overflow: hidden; }
        .header h1 { font-size: 3.5rem; margin-bottom: 10px; display: flex; align-items: center; gap: 15px; position: relative; }
        .header h1 i { color: #ffd700; }
        
        /* Stats Cards */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); display: flex; align-items: center; gap: 20px; transition: transform 0.3s ease; }
        .stat-icon { width: 70px; height: 70px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 30px; color: white; }
        .stat-info .count { font-size: 2.5rem; font-weight: bold; color: #2d3436; }
        
        /* Controls */
        .controls { display: flex; gap: 15px; margin-bottom: 30px; flex-wrap: wrap; }
        .search-box { flex: 1; min-width: 300px; position: relative; }
        .search-box input { width: 100%; padding: 18px 20px 18px 50px; border: none; border-radius: 50px; background: #f8f9fa; font-size: 16px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); }
        .search-box i { position: absolute; left: 20px; top: 50%; transform: translateY(-50%); color: #667eea; }
        
        .btn { padding: 15px 30px; border: none; border-radius: 50px; font-size: 16px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 10px; transition: 0.3s; }
        .btn-primary { background: linear-gradient(135deg, #D32F2F 0%, #B71C1C 100%); color: white; }
        .btn-secondary { background: #f1f3f4; color: #333; }
        
        /* Grid */
        .pairings-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 25px; margin-top: 20px; }
        .pairing-card { background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1); position: relative; border: 1px solid #f1f3f4; transition: 0.3s; }
        .pairing-card:hover { transform: translateY(-10px); }
        
        /* Card Styles */
        .image-container { position: relative; height: 200px; overflow: hidden; }
        .ship-image { width: 100%; height: 100%; object-fit: cover; }
        .image-overlay { position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(transparent, rgba(0,0,0,0.7)); padding: 20px; color: white; }
        .card-header { background: linear-gradient(135deg, #1A237E 0%, #283593 100%); color: white; padding: 20px; min-height: 120px; display: flex; flex-direction: column; justify-content: center; }
        .pairing-name { font-size: 1.8rem; font-weight: bold; }
        .card-body { padding: 25px; }
        .info-row { display: flex; margin-bottom: 12px; border-bottom: 1px solid #f0f0f0; padding-bottom: 8px; }
        .info-label { font-weight: 600; color: #666; width: 100px; }
        
        /* Tags */
        .tags-container { display: flex; gap: 8px; margin-top: 15px; flex-wrap: wrap; }
        .tag { padding: 5px 12px; border-radius: 50px; font-size: 0.8rem; font-weight: 600; display: flex; align-items: center; gap: 5px; }
        .canon { background: #E8F5E9; color: #2E7D32; }
        .fanon { background: #E3F2FD; color: #1565C0; }
        .romantic { background: #FFEBEE; color: #C62828; }
        
        /* Actions */
        .card-actions { position: absolute; top: 15px; right: 15px; display: flex; gap: 8px; z-index: 10; opacity: 0; transition: 0.3s; }
        .pairing-card:hover .card-actions { opacity: 1; }
        .action-btn { width: 35px; height: 35px; border-radius: 50%; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .edit-btn { color: #2196F3; }
        .delete-btn { color: #f44336; }
        
        /* Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center; padding: 20px; }
        .modal-content { background: white; border-radius: 20px; max-width: 600px; width: 100%; max-height: 90vh; overflow-y: auto; }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 600; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; }
        
        .toast { position: fixed; bottom: 20px; right: 20px; background: #333; color: white; padding: 15px 25px; border-radius: 10px; z-index: 2000; display: none; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-heart"></i> Fandom Relationships</h1>
            <p>I'm tracking and organizing the relationships I like across any fandoms I'm in. ✨</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon" style="background: #D32F2F;"><i class="fas fa-heart"></i></div>
                <div class="stat-info"><h3>TOTAL</h3><div class="count" id="total-count">0</div></div>
            </div>
            <div class="stat-card">
                <div class="stat-icon" style="background: #FFD700;"><i class="fas fa-star"></i></div>
                <div class="stat-info"><h3>FAVORITES</h3><div class="count" id="favorite-count">0</div></div>
            </div>
            <div class="stat-card">
                <div class="stat-icon" style="background: #2E7D32;"><i class="fas fa-check-circle"></i></div>
                <div class="stat-info"><h3>CANON</h3><div class="count" id="canon-count">0</div></div>
            </div>
        </div>
        
        <div class="controls">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-input" placeholder="Search ships..." onkeyup="applyFilters()">
            </div>
            <button class="btn btn-primary" onclick="openAddModal()"><i class="fas fa-plus"></i> Add Ship</button>
            <button class="btn btn-secondary" onclick="exportData()"><i class="fas fa-file-export"></i> Export</button>
            <button class="btn btn-secondary" onclick="openImportModal()"><i class="fas fa-file-import"></i> Import</button>
        </div>
        
        <div class="pairings-grid" id="pairings-grid"></div>

        <div class="modal" id="add-modal">
            <div class="modal-content">
                <div class="card-header" style="border-radius: 20px 20px 0 0;">
                    <h2 id="modal-title" style="color: white;">Add New Ship</h2>
                </div>
                <div style="padding: 30px;">
                    <form id="pairing-form" onsubmit="event.preventDefault(); saveShip();">
                        <div class="form-grid">
                            <div class="form-group"><label>Ship Name *</label><input type="text" id="input-name" required></div>
                            <div class="form-group"><label>Characters *</label><input type="text" id="input-characters" required></div>
                        </div>
                        <div class="form-group"><label>Image URL</label><input type="text" id="input-image" placeholder="https://..."></div>
                        <div class="form-grid">
                            <div class="form-group"><label>Fandom</label><input type="text" id="input-fandom" required></div>
                            <div class="form-group">
                                <label>Status</label>
                                <select id="input-status"><option>Canon</option><option>Fanon</option><option>Crack</option></select>
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Relationship</label>
                                <select id="input-relationship"><option>Romantic</option><option>Platonic</option><option>Enemies to Lovers</option></select>
                            </div>
                            <div class="form-group"><label>Favorite? <input type="checkbox" id="input-favorite"></label></div>
                        </div>
                        <div class="form-group"><label>Notes</label><textarea id="input-notes" rows="2"></textarea></div>
                        <div style="display: flex; gap: 10px;">
                            <button type="button" class="btn btn-secondary" onclick="closeAddModal()" style="flex: 1;">Cancel</button>
                            <button type="submit" class="btn btn-primary" style="flex: 2;">Save Ship</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="modal" id="import-modal">
            <div class="modal-content" style="max-width: 400px; padding: 30px;">
                <h3>Import JSON</h3>
                <input type="file" id="import-file" accept=".json" style="margin: 20px 0;">
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-secondary" onclick="closeImportModal()">Cancel</button>
                    <button class="btn btn-primary" onclick="importData()">Upload</button>
                </div>
            </div>
        </div>

        <div id="toast" class="toast"></div>
    </div>
    
    <script>
        let pairings = [];
        let editingId = null;

        window.onload = loadFromStorage;

        function loadFromStorage() {
            const saved = localStorage.getItem('fandomShips');
            if (saved) {
                pairings = JSON.parse(saved);
            } else {
                // Initial Sample
                pairings = [{ id: 1, name: "Stony", characters: "Steve x Tony", fandom: "MCU", status: "Fanon", relationship: "Romantic", favorite: true, notes: "Best dynamic.", image: "" }];
            }
            renderShips();
        }

        function saveToStorage() {
            localStorage.setItem('fandomShips', JSON.stringify(pairings));
            renderShips();
        }

        function renderShips(data = pairings) {
            const grid = document.getElementById('pairings-grid');
            grid.innerHTML = '';
            
            data.forEach(ship => {
                const card = document.createElement('div');
                card.className = 'pairing-card';
                card.innerHTML = `
                    <div class="card-actions">
                        <button class="action-btn edit-btn" onclick="openEditModal(${ship.id})"><i class="fas fa-edit"></i></button>
                        <button class="action-btn delete-btn" onclick="deleteShip(${ship.id})"><i class="fas fa-trash"></i></button>
                    </div>
                    ${ship.image ? `<div class="image-container"><img src="${ship.image}" class="ship-image"><div class="image-overlay"><h3 class="pairing-name">${ship.name}</h3></div></div>` 
                                : `<div class="card-header"><h3 class="pairing-name">${ship.name}</h3><p>${ship.characters}</p></div>`}
                    <div class="card-body">
                        <div class="info-row"><span class="info-label">Fandom:</span><span>${ship.fandom}</span></div>
                        <p style="font-size: 0.9rem; color: #666; font-style: italic;">${ship.notes || ''}</p>
                        <div class="tags-container">
                            <span class="tag ${ship.status.toLowerCase()}">${ship.status}</span>
                            <span class="tag romantic">${ship.relationship}</span>
                            ${ship.favorite ? '<span class="tag" style="background:#FFD700; color:#000;">★ Favorite</span>' : ''}
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });

            document.getElementById('total-count').innerText = pairings.length;
            document.getElementById('favorite-count').innerText = pairings.filter(p => p.favorite).length;
            document.getElementById('canon-count').innerText = pairings.filter(p => p.status === 'Canon').length;
        }

        function openAddModal() {
            editingId = null;
            document.getElementById('modal-title').innerText = "Add New Ship";
            document.getElementById('pairing-form').reset();
            document.getElementById('add-modal').style.display = 'flex';
        }

        function closeAddModal() { document.getElementById('add-modal').style.display = 'none'; }

        // --- THE FIXED EDIT LOGIC ---
        function openEditModal(id) {
            const ship = pairings.find(p => p.id === id);
            if (!ship) return;

            editingId = id;
            document.getElementById('modal-title').innerText = "Edit Ship";
            
            // Fill the form with existing data
            document.getElementById('input-name').value = ship.name;
            document.getElementById('input-characters').value = ship.characters;
            document.getElementById('input-fandom').value = ship.fandom;
            document.getElementById('input-status').value = ship.status;
            document.getElementById('input-relationship').value = ship.relationship;
            document.getElementById('input-favorite').checked = ship.favorite;
            document.getElementById('input-notes').value = ship.notes || '';
            document.getElementById('input-image').value = ship.image || '';

            document.getElementById('add-modal').style.display = 'flex';
        }

        function saveShip() {
            const shipData = {
                id: editingId || Date.now(),
                name: document.getElementById('input-name').value,
                characters: document.getElementById('input-characters').value,
                fandom: document.getElementById('input-fandom').value,
                status: document.getElementById('input-status').value,
                relationship: document.getElementById('input-relationship').value,
                favorite: document.getElementById('input-favorite').checked,
                notes: document.getElementById('input-notes').value,
                image: document.getElementById('input-image').value
            };

            if (editingId) {
                const index = pairings.findIndex(p => p.id === editingId);
                pairings[index] = shipData;
                showToast("Ship updated!");
            } else {
                pairings.unshift(shipData);
                showToast("Ship added!");
            }

            saveToStorage();
            closeAddModal();
        }

        function deleteShip(id) {
            if(confirm("Delete this ship?")) {
                pairings = pairings.filter(p => p.id !== id);
                saveToStorage();
            }
        }

        function applyFilters() {
            const search = document.getElementById('search-input').value.toLowerCase();
            const filtered = pairings.filter(p => p.name.toLowerCase().includes(search) || p.fandom.toLowerCase().includes(search));
            renderShips(filtered);
        }

        function exportData() {
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(pairings, null, 2));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "pairings.json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
        }

        function openImportModal() { document.getElementById('import-modal').style.display = 'flex'; }
        function closeImportModal() { document.getElementById('import-modal').style.display = 'none'; }

        function importData() {
            const file = document.getElementById('import-file').files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                pairings = JSON.parse(e.target.result);
                saveToStorage();
                closeImportModal();
            };
            reader.readAsText(file);
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.style.display = 'block';
            setTimeout(() => t.style.display = 'none', 3000);
        }

        window.onclick = (e) => { if (e.target.className === 'modal') { closeAddModal(); closeImportModal(); } };
    </script>

    <div style="text-align: center; padding: 20px; color: #666; font-size: 14px; border-top: 1px solid #ddd; margin-top: 30px;">
        <p>&copy; 2026 Bash - Fandom Relationship Database. All Rights Reserved.</p>
        <p style="font-size: 12px; margin-top: 5px; opacity: 0.8;">Organizing the chaos of shipping, one pairing at a time. ✨</p>
    </div>
</body>
</html>
